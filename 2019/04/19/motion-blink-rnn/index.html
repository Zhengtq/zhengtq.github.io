<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>&lt; Deeplearning &gt; Use CNN and RNN to detect blink in a video - Billy&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Billy&#039;s Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Billy&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Let’s do it!If you use your face to pay a sum of money by ALIPAY, you may find that it requires you to do some facial movement to check whether you are a real person or not.  So as you see, facial mot"><meta property="og:type" content="article"><meta property="og:title" content="&lt; Deeplearning &gt; Use CNN and RNN to detect blink in a video"><meta property="og:url" content="https://zhengtq.github.io/2019/04/19/motion-blink-rnn/"><meta property="og:site_name" content="Billy&#039;s Blog"><meta property="og:description" content="Let’s do it!If you use your face to pay a sum of money by ALIPAY, you may find that it requires you to do some facial movement to check whether you are a real person or not.  So as you see, facial mot"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://zhengtq.github.io/img/og_image.png"><meta property="article:published_time" content="2019-04-19T08:04:59.000Z"><meta property="article:modified_time" content="2021-03-12T08:02:05.872Z"><meta property="article:author" content="Billy"><meta property="article:tag" content="Deeplearning"><meta property="article:tag" content="Antispoofing"><meta property="article:tag" content="RNN"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhengtq.github.io/2019/04/19/motion-blink-rnn/"},"headline":"< Deeplearning > Use CNN and RNN to detect blink in a video","image":["https://zhengtq.github.io/img/og_image.png"],"datePublished":"2019-04-19T08:04:59.000Z","dateModified":"2021-03-12T08:02:05.872Z","author":{"@type":"Person","name":"Billy"},"description":"Let’s do it!If you use your face to pay a sum of money by ALIPAY, you may find that it requires you to do some facial movement to check whether you are a real person or not.  So as you see, facial mot"}</script><link rel="canonical" href="https://zhengtq.github.io/2019/04/19/motion-blink-rnn/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Billy&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-04-19T08:04:59.000Z" title="4/19/2019, 4:04:59 PM">2019-04-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-03-12T08:02:05.872Z" title="3/12/2021, 4:02:05 PM">2021-03-12</time></span><span class="level-item"><a class="link-muted" href="/categories/Deeplearning/">Deeplearning</a></span></div></div><h1 class="title is-3 is-size-4-mobile">&lt; Deeplearning &gt; Use CNN and RNN to detect blink in a video</h1><div class="content"><h1 id="Let’s-do-it"><a href="#Let’s-do-it" class="headerlink" title="Let’s do it!"></a>Let’s do it!</h1><p>If you use your face to pay a sum of money by ALIPAY, you may find that it requires you to do some facial movement to check whether you are a real person or not. </p>
<p>So as you see, facial motion detection is  actually being used in many circumstances. You may want to figure out how to detect facial motion. </p>
<p>In this post, I will take motion blink as a example to demonstrate how to do realize it. </p>
<p>So Let’s do it.<br><span id="more"></span></p>
<h1 id="How-to-‘make’-data-if-you-do-not-have"><a href="#How-to-‘make’-data-if-you-do-not-have" class="headerlink" title="How to ‘make’ data if you do not have"></a>How to ‘make’ data if you do not have</h1><p>Of course we can use thousands of blinking video sequences to train a RNN classifier. But it may be difficult yet inefficient to collect blink video. So how to simulate blinking data by using single eye image.<br>As everyone know, a blink sequence contains opening eye, closing eye and opening eye again. We can modeling blink motion as a sequence of eye opening and eye closing. So even you have just 100 opening eye images and 100 closing eye images, you can creats millions of eye blinking sequence. Quite surprising!</p>
<h1 id="Build-your-blinking-detection-system"><a href="#Build-your-blinking-detection-system" class="headerlink" title="Build your blinking detection system ?"></a>Build your blinking detection system ?</h1><p>Is seems is over. The last step is to use a RNN model to train a blink detection model by using the above fake training sequece. If you have read my former <a href="https://zhengtq.github.io/2019/01/05/tf-rnn-gru/">post</a> , you may understand how GRU works in tensorflow. So we will start from here to demonstrate you how to detect blink based on GRU. Of course you can use conv-gru to simply use raw eye imaga sequence to get a end-to-end blink detection system.<br>However if you want to make the task simple, you can also firstly train a CNN binary classifier to classify if eye close or not. And then you can use the classifier as a feature extractor to extract feature of eye and then form a sequence as the input of your RNN network,</p>
<h1 id="To-make-the-system-more-accurate"><a href="#To-make-the-system-more-accurate" class="headerlink" title="To make the system more accurate."></a>To make the system more accurate.</h1><p>In order to make your blink system more accurate, to make the input feature to RNN more robust is very important. So you have to make sure you have trained a good CNN classifier. You can use facial landmarks(from any open source code) to get the landmarks of the face image and extract the eye part of the face image. One thing to be mentioned, you can use landmark points of the eye as parts of the whole input feature(combined with the feature extracted from you CNN classifier) to make the feature more robust.<br>Next, you have to figure out to make simulate a good sequence to train your RNN model. You can create many “hard sequence”  and do not neglect any blinking circumstances. One thing to be remembered, the more diverse your training sequence is, the more accurate your blink system is.</p>
<h1 id="Is-not-over"><a href="#Is-not-over" class="headerlink" title="Is not over."></a>Is not over.</h1><p>So now we have a simple eye blinking detection system. But there are many other questions should be answered. There first question is how many frame could be used to detection blink. The answer is quite simple: as many as you like. So in order to do this, you may train a RNN model based on variable length sequence(We have to define the max sequence length).  Another question is how do you design your actual system logic when you apply your model on real time video stream. And just leave the second question to you.</p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Deeplearning/">Deeplearning</a><a class="link-muted mr-2" rel="tag" href="/tags/Antispoofing/">Antispoofing</a><a class="link-muted mr-2" rel="tag" href="/tags/RNN/">RNN</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/04/24/op-summary/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">&lt;Deeplarning&gt; A simple way to distinguish different optimizers in DeepLearning</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/04/19/linux-install-config/"><span class="level-item">&lt; Linux &gt; As a AI-practitioner, what I install in my linux system</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Billy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Billy</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">45</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">10</p></a></div></div></nav></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-27T00:38:00.000Z">2021-01-27</time></p><p class="title"><a href="/2021/01/27/tf2-x-best-practice/">&lt; Tensorflow &gt;Tensorflow2.4 最佳实践</a></p><p class="categories"><a href="/categories/Tensorflow/">Tensorflow</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-28T05:54:05.000Z">2020-12-28</time></p><p class="title"><a href="/2020/12/28/ncnn-lesson-start/">&lt; NCNN-Lession-Start &gt;　Start</a></p><p class="categories"><a href="/categories/Deeplearning/">Deeplearning</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-21T03:10:11.000Z">2020-12-21</time></p><p class="title"><a href="/2020/12/21/ncnn-lesson-10/">&lt; NCNN-Lession-10 &gt;　Forward Net</a></p><p class="categories"><a href="/categories/Deeplearning/">Deeplearning</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-21T03:10:11.000Z">2020-12-21</time></p><p class="title"><a href="/2020/12/21/ncnn-lesson-9/">&lt; NCNN-Lession-9 &gt;　Load Image</a></p><p class="categories"><a href="/categories/Deeplearning/">Deeplearning</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-18T02:19:11.000Z">2020-12-18</time></p><p class="title"><a href="/2020/12/18/ncnn-lesson-8/">&lt; NCNN-Lession-8 &gt;　读取网络的权重信息</a></p><p class="categories"><a href="/categories/Deeplearning/">Deeplearning</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Billy&#039;s Blog</a><p class="is-size-7"><span>&copy; 2021 Billy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--></body></html>