<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>&lt; Antispoofing &gt;　如何科学的攻破活体识别系统 - Billy&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Billy&#039;s Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Billy&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="前言故事(事故)起源于我老大最近跟我说的一个脑洞，他说他最近看了Advhat 的相关介绍，说能不能在活体识别上面尝试一下Advhat, 仿照Advhat做一个特殊贴纸，贴到一张假脸的某个部位，然后就用这样的一张贴了特殊纸张的假脸攻破活体识别系统．我当时觉得应该不太可能，毕竟活体任务和人脸识别任务不同，活体识别任务学的就是真人和非真人介质的不同，无论生成什么样的纸张，毕竟逃离不了纸张透过摄像头的后的"><meta property="og:type" content="article"><meta property="og:title" content="&lt; Antispoofing &gt;　如何科学的攻破活体识别系统"><meta property="og:url" content="http://yoursite.com/2020/01/17/advAS/"><meta property="og:site_name" content="Billy&#039;s Blog"><meta property="og:description" content="前言故事(事故)起源于我老大最近跟我说的一个脑洞，他说他最近看了Advhat 的相关介绍，说能不能在活体识别上面尝试一下Advhat, 仿照Advhat做一个特殊贴纸，贴到一张假脸的某个部位，然后就用这样的一张贴了特殊纸张的假脸攻破活体识别系统．我当时觉得应该不太可能，毕竟活体任务和人脸识别任务不同，活体识别任务学的就是真人和非真人介质的不同，无论生成什么样的纸张，毕竟逃离不了纸张透过摄像头的后的"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/1.png"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/2.png"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/3.png"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/4.png"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/111.png"><meta property="og:image" content="http://yoursite.com/2020/01/17/advAS/222.png"><meta property="article:published_time" content="2020-01-17T06:53:39.000Z"><meta property="article:modified_time" content="2020-11-17T11:29:12.970Z"><meta property="article:author" content="Billy"><meta property="article:tag" content="Deeplearning"><meta property="article:tag" content="Antispoofing"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2020/01/17/advAS/1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/01/17/advAS/"},"headline":"< Antispoofing >　如何科学的攻破活体识别系统","image":["http://yoursite.com/2020/01/17/advAS/1.png","http://yoursite.com/2020/01/17/advAS/2.png","http://yoursite.com/2020/01/17/advAS/3.png","http://yoursite.com/2020/01/17/advAS/4.png","http://yoursite.com/2020/01/17/advAS/111.png","http://yoursite.com/2020/01/17/advAS/222.png"],"datePublished":"2020-01-17T06:53:39.000Z","dateModified":"2020-11-17T11:29:12.970Z","author":{"@type":"Person","name":"Billy"},"description":"前言故事(事故)起源于我老大最近跟我说的一个脑洞，他说他最近看了Advhat 的相关介绍，说能不能在活体识别上面尝试一下Advhat, 仿照Advhat做一个特殊贴纸，贴到一张假脸的某个部位，然后就用这样的一张贴了特殊纸张的假脸攻破活体识别系统．我当时觉得应该不太可能，毕竟活体任务和人脸识别任务不同，活体识别任务学的就是真人和非真人介质的不同，无论生成什么样的纸张，毕竟逃离不了纸张透过摄像头的后的"}</script><link rel="canonical" href="http://yoursite.com/2020/01/17/advAS/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Billy&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-01-17T06:53:39.000Z" title="1/17/2020, 2:53:39 PM">2020-01-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-11-17T11:29:12.970Z" title="11/17/2020, 7:29:12 PM">2020-11-17</time></span><span class="level-item"><a class="link-muted" href="/categories/Deeplearning/">Deeplearning</a></span></div></div><h1 class="title is-3 is-size-4-mobile">&lt; Antispoofing &gt;　如何科学的攻破活体识别系统</h1><div class="content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>故事(事故)起源于我老大最近跟我说的一个脑洞，他说他最近看了<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1908.08705">Advhat</a> 的相关介绍，说能不能在活体识别上面尝试一下Advhat, 仿照Advhat做一个特殊贴纸，贴到一张假脸的某个部位，然后就用这样的一张贴了特殊纸张的假脸攻破活体识别系统．我当时觉得应该不太可能，毕竟活体任务和人脸识别任务不同，活体识别任务学的就是真人和非真人介质的不同，无论生成什么样的纸张，毕竟逃离不了纸张透过摄像头的后的独特介质信息，况且即使生成了特殊的贴纸，然后再打印出来，然后再通过摄像头去识别，这样这张生成的’数字’贴纸就经过了两次失真，应该是没啥效果的．我就把我的观点和老大一说，老大说还是让我尝试一下．于是我就做个实验验证一下，没想到我被实验结果深深的打脸．．．<br><span id="more"></span></p>
<h1 id="简单回顾Advhat"><a href="#简单回顾Advhat" class="headerlink" title="简单回顾Advhat"></a>简单回顾Advhat</h1><p>Advhat　主要是基于Fast Gradient-Sign　Method (<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1412.6572">FGSM</a>)通过设计好的Loss来对输入进行梯度回传，然后把输入以一定的方式加上输入对应的梯度来实现梯度上升，从达到使之前的Loss上升，模型输出错误的目的. Advhat为了使得生成的贴纸在实际贴到脸上之后中更加的鲁棒，在合成贴纸人脸的时候做了三个个小的trick,<br>第一个trick就是给矩形的贴纸做形态的变换，使得其达到在贴到额头上的弯曲程度．如下图所示:<br> <img src="/2020/01/17/advAS/1.png" alt=""><br>第二个trick是使用了stn(Spatial Transformer Network<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1506.02025">Spatial Transformer Network</a>),给贴到的人脸图像做位置和形态的细微扰动，使得其生成的贴纸到实际贴到额头上能够更加的鲁棒．<br>第三个trick是作者使用了Total Variation Loss(TV_loss)让图像看起来更加的平滑自然．<br>最终的流程图如下图所示:<br> <img src="/2020/01/17/advAS/2.png" alt=""><br>其中A是原始的人脸，B是生成的贴纸，C是合成的贴纸人脸．cos_loss的目的是增大真脸的embedding和贴纸的脸的embedding的距离，从而达到模型误识别．grad1是cos_loss对图像C的梯度，grad2是图像C对贴纸B的梯度．grad3是tvloss对贴纸B的梯度，整个迭代过程中不会改变任何的’CLS _model’的参数，’CLS_model’只是为了计算loss,回传梯度．所以你可以把需改变的贴纸B当成weight，把’CLS_model’的所有weight当成常量参数．<br>所以最终用于更新贴纸B的梯度为:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grad_update = grad2*grad1 + alpha * grad3</span><br></pre></td></tr></table></figure><br>其中alpha是控制两个梯度的比例银子．</p>
<h1 id="活体实验过程"><a href="#活体实验过程" class="headerlink" title="活体实验过程"></a>活体实验过程</h1><p>所以活体的实验就是把上面示意图中的图像变成某一个攻击图片的图像，然后生成一个额头上mask，使得把这个mask贴到假体额头上可以把该假体攻击照片识别为真人．与advhat不一样的是，这个mask不需要为了适应额头的弯曲程度而矩形的形态变换，因为很多攻击都是平面的，我的初步实验也是在一个二维的裁剪纸张上面做的．为了表示方便，我下面会把额头戴mask的假体叫做mask假体，把对应的真实的假体叫做原始假体．总体示意图如下：<br> <img src="/2020/01/17/advAS/3.png" alt=""><br> 同样梯度更新的方式是一样的．只不过grad2不需要经过projection了．为了直观观察迭代情况，我在迭代的时候把mask经过活体模型的loss和置信度(Confidence)的值同样做了输出(在活体分类模型中，真人的标签是1，攻击的标签是0):<br> <img src="/2020/01/17/advAS/4.png" alt=""><br>从上图可以看到，刚开始mask假体经过判别模型的置信度是一个很低的数值，也就是说迭代刚开始活体模型可以很好的判定mask假体就是一个假体．但随着迭代的增加，mask假体的置信度在fgsm迭代的作用下上升的很快，迭代到100步就已经可以达到99%置信度的水平了，换言之，该人脸(假脸)有以很大的置信度被活体模型识别为了真人．于是我打算看一下下生成的mask到底是啥样的，是不是类似于advhat那样的类似于人的额头的mask.于是我把不同迭代次数生成的mask保存下来，并看到了下面的东西(为了安全起见，我对图片做了黑白处理):<br> <img src="/2020/01/17/advAS/111.png" alt=""><br> <img src="/2020/01/17/advAS/222.png" alt=""> </p>
<p>虽然到现在为止的实验结果显示额头贴纸可以很好的把一个攻击假体让神经网络识别为真人．但我还是很疑虑的觉得如果把贴纸打印出来然后贴到假体额头上可能会不起作用，毕竟模拟的mask和现实的mask还是有很大的不同的．现实的mask还要经过两次失真，一次是打印机打印的失真，一次是摄像头拍摄的失真．而活体模型学到的或许就是跟这两次失真有关的特征．于是我就去实际打印出来验证了一下，结果就像开头说的，我被深深的打脸，给攻击人脸贴纸确实是有攻入活体识别模型的可能性.放一下视频看一下效果(隐私起见，对眼睛做了马赛克处理，同时做了黑白处理)：</p>
<p><iframe src="//player.bilibili.com/player.html?aid=84509158&cid=144544772&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><br>(实在不知道怎么调整视频的长宽大小，建议放大网页看视频)</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>当然，虽然发现贴纸攻击对于活体识别模型是有效的，现在也大可不必担心活体识别的有效性．对于活体识别来说，贴纸攻击的有效性跟纸张方式选择，摄像头，打印机和光线角度都有关．我亲自试验过，同一张贴纸，我换一个环境或者是换一张人脸它就失效了.　而且，今天说的攻击方式本质是白盒攻击，必须要拿到活体模型的内部结构和参数才可以生成对应的贴纸，而想要从手机里面拿到完整的活体模型也是一件很困难的事情，所以大家大可不必过于担心现今FaceID的安全性．</p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Deeplearning/">Deeplearning</a><a class="link-muted mr-2" rel="tag" href="/tags/Antispoofing/">Antispoofing</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/03/20/advnoise/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">&lt; Deeplearning &gt; TF实操Game of Noise</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/10/19/saferm/"><span class="level-item">&lt; Linux &gt; A Safe Way to Use Deletion Command In Linux.</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Billy&#039;s Blog</a><p class="is-size-7"><span>&copy; 2021 Billy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--></body></html>